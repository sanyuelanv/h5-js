/**
 * Created by sanyuelanv on 2015/8/11.
 */
var BinaryFile=function(f,c,b){var d=f;var a=c||0;var e=0;this.getRawData=function(){return d};if(typeof f=="string"){e=b||d.length;this.getByteAt=function(g){return d.charCodeAt(g+a)&255};this.getBytesAt=function(k,j){var g=[];for(var h=0;h<j;h++){g[h]=d.charCodeAt((k+h)+a)&255}return g}}else{if(typeof f=="unknown"){e=b||IEBinary_getLength(d);this.getByteAt=function(g){return IEBinary_getByteAt(d,g+a)};this.getBytesAt=function(h,g){return new VBArray(IEBinary_getBytesAt(d,h+a,g)).toArray()}}}this.getLength=function(){return e};this.getSByteAt=function(h){var g=this.getByteAt(h);if(g>127){return g-256}else{return g}};this.getShortAt=function(i,g){var h=g?(this.getByteAt(i)<<8)+this.getByteAt(i+1):(this.getByteAt(i+1)<<8)+this.getByteAt(i);if(h<0){h+=65536}return h};this.getSShortAt=function(i,h){var g=this.getShortAt(i,h);if(g>32767){return g-65536}else{return g}};this.getLongAt=function(l,h){var k=this.getByteAt(l),j=this.getByteAt(l+1),i=this.getByteAt(l+2),g=this.getByteAt(l+3);var m=h?(((((k<<8)+j)<<8)+i)<<8)+g:(((((g<<8)+i)<<8)+j)<<8)+k;if(m<0){m+=4294967296}return m};this.getSLongAt=function(i,g){var h=this.getLongAt(i,g);if(h>2147483647){return h-4294967296}else{return h}};this.getStringAt=function(l,k){var h=[];var g=this.getBytesAt(l,k);for(var i=0;i<k;i++){h[i]=String.fromCharCode(g[i])}return h.join("")};this.getCharAt=function(g){return String.fromCharCode(this.getByteAt(g))};this.toBase64=function(){return window.btoa(d)};this.fromBase64=function(g){d=window.atob(g)}};var EXIF={};(function(){var h=false;EXIF.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"};EXIF.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};EXIF.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"};EXIF.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function d(j,l,k){if(j.addEventListener){j.addEventListener(l,k,false)}else{if(j.attachEvent){j.attachEvent("on"+l,k)}}}function c(j){return !!(j.exifdata)}function e(k,j){BinaryAjax(k.src,function(l){var m=a(l.binaryResponse);k.exifdata=m||{};if(j){j()}})}function a(m){var j=[];if(m.getByteAt(0)!=255||m.getByteAt(1)!=216){return false}var l=2;var k=m.getLength();while(l<k){if(m.getByteAt(l)!=255){if(h){console.log("Not a valid marker at offset "+l+", found: "+m.getByteAt(l))}return false}var n=m.getByteAt(l+1);if(n==22400){if(h){console.log("Found 0xFFE1 marker")}return g(m,l+4,m.getShortAt(l+2,true)-2);l+=2+m.getShortAt(l+2,true)}else{if(n==225){if(h){console.log("Found 0xFFE1 marker")}return g(m,l+4,m.getShortAt(l+2,true)-2)}else{l+=2+m.getShortAt(l+2,true)}}}}function f(q,n,s,k,p){var j=q.getShortAt(s,p);var o={};for(var l=0;l<j;l++){var r=s+l*12+2;var m=k[q.getShortAt(r,p)];if(!m&&h){console.log("Unknown tag: "+q.getShortAt(r,p))}o[m]=b(q,r,n,s,p)}return o}function b(t,v,o,u,q){var r=t.getShortAt(v+2,q);var s=t.getLongAt(v+4,q);var l=t.getLongAt(v+8,q)+o;switch(r){case 1:case 7:if(s==1){return t.getByteAt(v+8,q)}else{var j=s>4?l:(v+8);var p=[];for(var k=0;k<s;k++){p[k]=t.getByteAt(j+k)}return p}break;case 2:var m=s>4?l:(v+8);return t.getStringAt(m,s-1);break;case 3:if(s==1){return t.getShortAt(v+8,q)}else{var j=s>2?l:(v+8);var p=[];for(var k=0;k<s;k++){p[k]=t.getShortAt(j+2*k,q)}return p}break;case 4:if(s==1){return t.getLongAt(v+8,q)}else{var p=[];for(var k=0;k<s;k++){p[k]=t.getLongAt(l+4*k,q)}return p}break;case 5:if(s==1){return t.getLongAt(l,q)/t.getLongAt(l+4,q)}else{var p=[];for(var k=0;k<s;k++){p[k]=t.getLongAt(l+8*k,q)/t.getLongAt(l+4+8*k,q)}return p}break;case 9:if(s==1){return t.getSLongAt(v+8,q)}else{var p=[];for(var k=0;k<s;k++){p[k]=t.getSLongAt(l+4*k,q)}return p}break;case 10:if(s==1){return t.getSLongAt(l,q)/t.getSLongAt(l+4,q)}else{var p=[];for(var k=0;k<s;k++){p[k]=t.getSLongAt(l+8*k,q)/t.getSLongAt(l+4+8*k,q)}return p}break}}function g(r,j,l){if(r.getStringAt(j,4)!="Exif"){if(h){console.log("Not valid EXIF data! "+r.getStringAt(j,4))}return false}var p;var m=j+6;if(r.getShortAt(m)==18761){p=false}else{if(r.getShortAt(m)==19789){p=true}else{if(h){console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)")}return false}}if(r.getShortAt(m+2,p)!=42){if(h){console.log("Not valid TIFF data! (no 0x002A)")}return false}if(r.getLongAt(m+4,p)!=8){if(h){console.log("Not valid TIFF data! (First offset not 8)",r.getShortAt(m+4,p))}return false}var o=f(r,m,m+8,EXIF.TiffTags,p);if(o.ExifIFDPointer){var q=f(r,m,m+o.ExifIFDPointer,EXIF.Tags,p);for(var n in q){switch(n){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":q[n]=EXIF.StringValues[n][q[n]];break;case"ExifVersion":case"FlashpixVersion":q[n]=String.fromCharCode(q[n][0],q[n][1],q[n][2],q[n][3]);break;case"ComponentsConfiguration":q[n]=EXIF.StringValues.Components[q[n][0]]+EXIF.StringValues.Components[q[n][1]]+EXIF.StringValues.Components[q[n][2]]+EXIF.StringValues.Components[q[n][3]];break}o[n]=q[n]}}if(o.GPSInfoIFDPointer){var k=f(r,m,m+o.GPSInfoIFDPointer,EXIF.GPSTags,p);for(var n in k){switch(n){case"GPSVersionID":k[n]=k[n][0]+"."+k[n][1]+"."+k[n][2]+"."+k[n][3];break}o[n]=k[n]}}return o}EXIF.getData=function(k,j){if(!k.complete){return false}if(!c(k)){e(k,j)}else{if(j){j()}}return true};EXIF.getTag=function(k,j){if(!c(k)){return}return k.exifdata[j]};EXIF.getAllTags=function(l){if(!c(l)){return{}}var m=l.exifdata;var k={};for(var j in m){if(m.hasOwnProperty(j)){k[j]=m[j]}}return k};EXIF.pretty=function(l){if(!c(l)){return""}var m=l.exifdata;var k="";for(var j in m){if(m.hasOwnProperty(j)){if(typeof m[j]=="object"){k+=j+" : ["+m[j].length+" values]\r\n"}else{k+=j+" : "+m[j]+"\r\n"}}}return k};EXIF.readFromBinaryFile=function(j){return a(j)};function i(){var k=document.getElementsByTagName("img");for(var j=0;j<k.length;j++){if(k[j].getAttribute("exif")=="true"){if(!k[j].complete){d(k[j],"load",function(){EXIF.getData(this)})}else{EXIF.getData(k[j])}}}}d(window,"load",i)})();(function(){function d(j){var i=j.naturalWidth,l=j.naturalHeight;if(i*l>1024*1024){var k=document.createElement("canvas");k.width=k.height=1;var h=k.getContext("2d");h.drawImage(j,-i+1,0);return h.getImageData(0,0,1,1).data[3]===0}else{return false}}function e(l,i,q){var h=document.createElement("canvas");h.width=1;h.height=q;var r=h.getContext("2d");r.drawImage(l,0,0);var k=r.getImageData(0,0,1,q).data;var o=0;var m=q;var p=q;while(p>o){var j=k[(p-1)*4+3];if(j===0){m=p}else{o=p}p=(m+o)>>1}var n=(p/q);return(n===0)?1:n}function g(h,j,k){var i=document.createElement("canvas");b(h,i,j,k);return i.toDataURL("image/jpeg",j.quality||0.8)}function b(A,k,l,h){var n=A.naturalWidth,r=A.naturalHeight;if(!(n+r)){return}var v=l.width,u=l.height;var w=k.getContext("2d");w.save();c(k,w,v,u,l.orientation);var j=d(A);if(j){n/=2;r/=2}var z=1024;var i=document.createElement("canvas");i.width=i.height=z;var m=i.getContext("2d");var x=h?e(A,n,r):1;var q=Math.ceil(z*v/n);var y=Math.ceil(z*u/r/x);var s=0;var o=0;while(s<r){var t=0;var p=0;while(t<n){m.clearRect(0,0,z,z);m.drawImage(A,-t,-s);w.drawImage(i,0,0,z,z,p,o,q,y);t+=z;p+=q}s+=z;o+=y}w.restore();i=m=null}function c(k,i,l,h,j){switch(j){case 5:case 6:case 7:case 8:k.width=h;k.height=l;break;default:k.width=l;k.height=h}switch(j){case 2:i.translate(l,0);i.scale(-1,1);break;case 3:i.translate(l,h);i.rotate(Math.PI);break;case 4:i.translate(0,h);i.scale(1,-1);break;case 5:i.rotate(0.5*Math.PI);i.scale(1,-1);break;case 6:i.rotate(0.5*Math.PI);i.translate(0,-h);break;case 7:i.rotate(0.5*Math.PI);i.translate(l,-h);i.scale(-1,1);break;case 8:i.rotate(-0.5*Math.PI);i.translate(-l,0);break;default:break}}var a=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;function f(i){if(window.Blob&&i instanceof Blob){if(!a){throw Error("No createObjectURL function found to create blob url")}var h=new Image();h.src=a.createObjectURL(i);this.blob=i;i=h}if(!i.naturalWidth&&!i.naturalHeight){var j=this;i.onload=i.onerror=function(){var m=j.imageLoadListeners;if(m){j.imageLoadListeners=null;for(var l=0,k=m.length;l<k;l++){m[l]()}}};this.imageLoadListeners=[]}this.srcImage=i}f.prototype.render=function(n,v,s){if(this.imageLoadListeners){var m=this;this.imageLoadListeners.push(function(){m.render(n,v,s)});return}v=v||{};var o=this.srcImage.naturalWidth,p=this.srcImage.naturalHeight,i=v.width,t=v.height,r=v.maxWidth,q=v.maxHeight,u=!this.blob||this.blob.type==="image/jpeg";if(i&&!t){t=(p*i/o)<<0}else{if(t&&!i){i=(o*t/p)<<0}else{i=o;t=p}}if(r&&i>r){i=r;t=(p*i/o)<<0}if(q&&t>q){t=q;i=(o*t/p)<<0}var h={};for(var l in v){h[l]=v[l]}h.width=i;h.height=t;var j=n.tagName.toLowerCase();if(j==="img"){n.src=g(this.srcImage,h,u)}else{if(j==="canvas"){b(this.srcImage,n,h,u)}}if(typeof this.onrender==="function"){this.onrender(n)}if(s){s()}if(this.blob){this.blob=null;a.revokeObjectURL(this.srcImage.src)}};if(typeof define==="function"&&define.amd){define([],function(){return f})}else{this.MegaPixImage=f}})();function JPEGEncoder(k){var m=this;var C=Math.round;var K=Math.floor;var g=new Array(64);var J=new Array(64);var Q=new Array(64);var X=new Array(64);var A;var h;var q;var T;var I=new Array(65535);var l=new Array(65535);var O=new Array(64);var R=new Array(64);var i=[];var B=0;var a=7;var D=new Array(64);var d=new Array(64);var U=new Array(64);var e=new Array(256);var E=new Array(2048);var z;var N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63];var f=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];var b=[0,1,2,3,4,5,6,7,8,9,10,11];var y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125];var s=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250];var x=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];var Y=[0,1,2,3,4,5,6,7,8,9,10,11];var n=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119];var u=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(ag){var af=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var ae=0;ae<64;ae++){var aj=K((af[ae]*ag+50)/100);if(aj<1){aj=1}else{if(aj>255){aj=255}}g[N[ae]]=aj}var ah=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var ad=0;ad<64;ad++){var ai=K((ah[ad]*ag+50)/100);if(ai<1){ai=1}else{if(ai>255){ai=255}}J[N[ad]]=ai}var ac=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379];var ab=0;for(var ak=0;ak<8;ak++){for(var aa=0;aa<8;aa++){Q[ab]=(1/(g[N[ab]]*ac[ak]*ac[aa]*8));X[ab]=(1/(J[N[ab]]*ac[ak]*ac[aa]*8));ab++}}}function H(ae,af){var ad=0;var ag=0;var ac=new Array();for(var aa=1;aa<=16;aa++){for(var ab=1;ab<=ae[aa];ab++){ac[af[ag]]=[];ac[af[ag]][0]=ad;ac[af[ag]][1]=aa;ag++;ad++}ad*=2}return ac}function W(){A=H(f,b);h=H(x,Y);q=H(y,s);T=H(n,u)}function v(){var ab=1;var ad=2;for(var aa=1;aa<=15;aa++){for(var ac=ab;ac<ad;ac++){l[32767+ac]=aa;I[32767+ac]=[];I[32767+ac][1]=aa;I[32767+ac][0]=ac}for(var ae=-(ad-1);ae<=-ab;ae++){l[32767+ae]=aa;I[32767+ae]=[];I[32767+ae][1]=aa;I[32767+ae][0]=ad-1+ae}ab<<=1;ad<<=1}}function V(){for(var aa=0;aa<256;aa++){E[aa]=19595*aa;E[(aa+256)>>0]=38470*aa;E[(aa+512)>>0]=7471*aa+32768;E[(aa+768)>>0]=-11059*aa;E[(aa+1024)>>0]=-21709*aa;E[(aa+1280)>>0]=32768*aa+8421375;E[(aa+1536)>>0]=-27439*aa;E[(aa+1792)>>0]=-5329*aa}}function Z(ab){var ac=ab[0];var aa=ab[1]-1;while(aa>=0){if(ac&(1<<aa)){B|=(1<<a)}aa--;a--;if(a<0){if(B==255){r(255);r(0)}else{r(B)}a=7;B=0}}}function r(aa){i.push(e[aa])}function G(aa){r((aa>>8)&255);r((aa)&255)}function M(aY,av){var aM,aL,aK,aJ,aI,aG,aF,aD;var aP=0;var aR;var au=8;var an=64;for(aR=0;aR<au;++aR){aM=aY[aP];aL=aY[aP+1];aK=aY[aP+2];aJ=aY[aP+3];aI=aY[aP+4];aG=aY[aP+5];aF=aY[aP+6];aD=aY[aP+7];var aZ=aM+aD;var aO=aM-aD;var aX=aL+aF;var aQ=aL-aF;var aW=aK+aG;var aS=aK-aG;var aV=aJ+aI;var aT=aJ-aI;var ar=aZ+aV;var ao=aZ-aV;var aq=aX+aW;var ap=aX-aW;aY[aP]=ar+aq;aY[aP+4]=ar-aq;var aA=(ap+ao)*0.707106781;aY[aP+2]=ao+aA;aY[aP+6]=ao-aA;ar=aT+aS;aq=aS+aQ;ap=aQ+aO;var aw=(ar-ap)*0.382683433;var az=0.5411961*ar+aw;var ax=1.306562965*ap+aw;var ay=aq*0.707106781;var ak=aO+ay;var aj=aO-ay;aY[aP+5]=aj+az;aY[aP+3]=aj-az;aY[aP+1]=ak+ax;aY[aP+7]=ak-ax;aP+=8}aP=0;for(aR=0;aR<au;++aR){aM=aY[aP];aL=aY[aP+8];aK=aY[aP+16];aJ=aY[aP+24];aI=aY[aP+32];aG=aY[aP+40];aF=aY[aP+48];aD=aY[aP+56];var am=aM+aD;var at=aM-aD;var ah=aL+aF;var aB=aL-aF;var ae=aK+aG;var aE=aK-aG;var ab=aJ+aI;var aU=aJ-aI;var al=am+ab;var aa=am-ab;var ag=ah+ae;var ad=ah-ae;aY[aP]=al+ag;aY[aP+32]=al-ag;var ai=(ad+aa)*0.707106781;aY[aP+16]=aa+ai;aY[aP+48]=aa-ai;al=aU+aE;ag=aE+aB;ad=aB+at;var aN=(al-ad)*0.382683433;var af=0.5411961*al+aN;var a1=1.306562965*ad+aN;var ac=ag*0.707106781;var a0=at+ac;var aC=at-ac;aY[aP+40]=aC+af;aY[aP+24]=aC-af;aY[aP+8]=a0+a1;aY[aP+56]=a0-a1;aP++}var aH;for(aR=0;aR<an;++aR){aH=aY[aR]*av[aR];O[aR]=(aH>0)?((aH+0.5)|0):((aH-0.5)|0)}return O}function S(){G(65504);G(16);r(74);r(70);r(73);r(70);r(0);r(1);r(1);r(0);G(1);G(1);r(0);r(0)}function F(ab,aa){G(65472);G(17);r(8);G(aa);G(ab);r(3);r(1);r(17);r(0);r(2);r(17);r(1);r(3);r(17);r(1)}function t(){G(65499);G(132);r(0);for(var ab=0;ab<64;ab++){r(g[ab])}r(1);for(var aa=0;aa<64;aa++){r(J[aa])}}function p(){G(65476);G(418);r(0);for(var ae=0;ae<16;ae++){r(f[ae+1])}for(var ad=0;ad<=11;ad++){r(b[ad])}r(16);for(var ac=0;ac<16;ac++){r(y[ac+1])}for(var ab=0;ab<=161;ab++){r(s[ab])}r(1);for(var aa=0;aa<16;aa++){r(x[aa+1])}for(var ah=0;ah<=11;ah++){r(Y[ah])}r(17);for(var ag=0;ag<16;ag++){r(n[ag+1])}for(var af=0;af<=161;af++){r(u[af])}}function o(){G(65498);G(12);r(3);r(1);r(0);r(2);r(17);r(3);r(17);r(0);r(63);r(0)}function j(ae,aa,ak,ap,ao){var ag=ao[0];var ac=ao[240];var ad;var aq=16;var ah=63;var af=64;var ar=M(ae,aa);for(var al=0;al<af;++al){R[N[al]]=ar[al]}var an=R[0]-ak;ak=R[0];if(an==0){Z(ap[0])}else{ad=32767+an;Z(ap[l[ad]]);Z(I[ad])}var ab=63;for(;(ab>0)&&(R[ab]==0);ab--){}if(ab==0){Z(ag);return ak}var am=1;var au;while(am<=ab){var aj=am;for(;(R[am]==0)&&(am<=ab);++am){}var ai=am-aj;if(ai>=aq){au=ai>>4;for(var at=1;at<=au;++at){Z(ac)}ai=ai&15}ad=32767+R[am];Z(ao[(ai<<4)+l[ad]]);Z(I[ad]);am++}if(ab!=ah){Z(ag)}return ak}function w(){var ab=String.fromCharCode;for(var aa=0;aa<256;aa++){e[aa]=ab(aa)}}this.encode=function(aq,al,ai){var ac=new Date().getTime();if(al){c(al)}i=new Array();B=0;a=7;G(65496);S();t();F(aq.width,aq.height);p();o();var am=0;var at=0;var ap=0;B=0;a=7;this.encode.displayName="_encode_";var ay=aq.data;var av=aq.width;var ao=aq.height;var au=av*4;var ab=av*3;var ak,aj=0;var an,ax,az;var ad,ar,af,ah,ag;while(aj<ao){ak=0;while(ak<au){ad=au*aj+ak;ar=ad;af=-1;ah=0;for(ag=0;ag<64;ag++){ah=ag>>3;af=(ag&7)*4;ar=ad+(ah*au)+af;if(aj+ah>=ao){ar-=(au*(aj+1+ah-ao))}if(ak+af>=au){ar-=((ak+af)-au+4)}an=ay[ar++];ax=ay[ar++];az=ay[ar++];D[ag]=((E[an]+E[(ax+256)>>0]+E[(az+512)>>0])>>16)-128;d[ag]=((E[(an+768)>>0]+E[(ax+1024)>>0]+E[(az+1280)>>0])>>16)-128;U[ag]=((E[(an+1280)>>0]+E[(ax+1536)>>0]+E[(az+1792)>>0])>>16)-128}am=j(D,Q,am,A,q);at=j(d,X,at,h,T);ap=j(U,X,ap,h,T);ak+=32}aj+=8}if(a>=0){var aw=[];aw[1]=a+1;aw[0]=(1<<(a+1))-1;Z(aw)}G(65497);if(!ai){var aA=i.slice(0);i=[];var aa=new Date().getTime()-ac;console.log("Encoding time: "+aa+"ms");return aA}var ae="data:image/jpeg;base64,"+btoa(i.join(""));i=[];var aa=new Date().getTime()-ac;console.log("Encoding time: "+aa+"ms");return ae};function c(ab){if(ab<=0){ab=1}if(ab>100){ab=100}if(z==ab){return}var aa=0;if(ab<50){aa=Math.floor(5000/ab)}else{aa=Math.floor(200-ab*2)}L(aa);z=ab;console.log("Quality set to: "+ab+"%")}function P(){var ab=new Date().getTime();if(!k){k=50}w();W();v();V();c(k);var aa=new Date().getTime()-ab;console.log("Initialization "+aa+"ms")}P()}var MakePhoto=function(H){var n=H.loadImg||"data:image/gif;base64,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";var z=H.loadSize||{w:150,h:150};var F=H.id||0;var i=H.size||{w:"200",h:"200"};var C=H.pos||{x:"0",y:"0"};var x=H.limit||false;var u=H.camera||false;var a;if(H.touch==undefined){a=true}else{a=H.touch}u=u?'capture="camera"':"";var s,G;var b,D,h,I;var j=0,v=0;var E=false,k=false;var o={x:0,y:0},p={x:0,y:0};var M={x:0,y:0},m={width:0,height:0},r=0;var B=false;var t=0;this.createImage=function(T){s.height=i.h;s.width=i.w;var R=1;var P={x:parseInt(I.style.left.slice(0,-2)),y:parseInt(I.style.top.slice(0,-2))};var S={width:I.offsetWidth,height:I.offsetHeight};G.drawImage(I,P.x*R,P.y*R,S.width*R,S.height*R);var V="";if(/Android (\d+\.\d+)/.test(navigator.userAgent)){var U=new JPEGEncoder();V=U.encode(G.getImageData(0,0,s.width,s.height),T*100,true)}else{V=s.toDataURL("image/jpeg",T)}var O=V.split(",");if(O.length>=2){var Q=O[1];if(Q.length>0){return V}}};this.callFile=function(){D.removeEventListener("change",l,false);D.addEventListener("change",l,false);function O(Q,R){if(document.createEventObject){var P=document.createEventObject();return Q.fireEvent("on"+R,P)}else{var P=document.createEvent("HTMLEvents");P.initEvent(R,true,true);return !Q.dispatchEvent(P)}}O(D,"click")};this.scaleImg=function(S){var V=S;var R=I.offsetWidth*V;var O=I.offsetHeight*V;var Q=parseInt(I.style.left.slice(0,-2));var T=parseInt(I.style.top.slice(0,-2));var P=I.offsetWidth*(V-1)/2;var U=I.offsetHeight*(V-1)/2;Q=Q-P;T=T-U;I.style.width=R+"px";I.style.height=O+"px";I.style.left=Q+"px";I.style.top=T+"px"};function l(){if(this.files.length<=0){return}b.style.visibility="visible";var P=this.files[0];var O=new FileReader();O.onload=function(){var U=this.result;var Q=new BinaryFile(U);var R=EXIF.readFromBinaryFile(Q);var T=new Image();T.onload=function(){var ac=this.width,ad=this.height;var ae=h.offsetWidth/ac;var ab=h.offsetHeight/ad;var aa=ae>ab?ae:ab;var aa=aa;j=ac*aa;v=ad*aa;var X=(h.offsetWidth-j)*0.5;var W=(h.offsetHeight-v)*0.5;I.style.width=j+"px";I.style.height=v+"px";I.style.left=X+"px";I.style.top=W+"px";I.src=this.src;var Y=navigator.userAgent;var Z=/android|adr/gi.test(Y);var V=/iphone|ipod|ipad/gi.test(Y)&&!Z;var af=!Z&&!V;if(af){if(a){h.addEventListener("mousedown",w,false);h.addEventListener("mousemove",K,false);h.addEventListener("mouseup",f,false)}}else{if(a){h.addEventListener("touchstart",d,false);h.addEventListener("touchmove",A,false);h.addEventListener("touchend",J,false)}}b.style.visibility="hidden"};var S=new MegaPixImage(P);S.render(T,{maxWidth:960,maxHeight:960,orientation:R.Orientation})};O.readAsBinaryString(P)}function w(O){B=true;var P={"x":O.pageX,"y":O.pageY};y(P);O.preventDefault()}function K(O){if(!B){return}var P={"x":O.pageX,"y":O.pageY};q(P);O.preventDefault()}function f(O){B=false;if(E){E=false;N()}}function d(O){var R=O.touches||O.originalEvent.touches;var T=R[0];var S={"x":T.pageX,"y":T.pageY};if(R.length>=2){var Q=R[1];var P={"x":Q.pageX,"y":Q.pageY};e([S,P])}else{y(S)}}function A(O){var R=O.touches||O.originalEvent.touches;var T=R[0];var S={"x":T.pageX,"y":T.pageY};if(R.length>=2){var Q=R[1];var P={"x":Q.pageX,"y":Q.pageY};g([S,P])}else{q(S)}}function J(){if(E){E=false;N()}if(k){k=false;L()}}function e(P){E=false;var R=Math.abs(P[1].x-P[0].x);var O=Math.abs(P[1].y-P[0].y);r=Math.sqrt(R*R+O*O);if(r>0){var T={left:C.x,top:C.y};var S=(P[0].x+P[1].x)*0.5-T.left;var Q=(P[0].y+P[1].y)*0.5-T.top;M.x=(S-parseInt(I.style.left.slice(0,-2)))/I.offsetWidth;M.y=(Q-parseInt(I.style.top.slice(0,-2)))/I.offsetHeight;m.width=I.offsetWidth;m.height=I.offsetHeight;k=true}}function g(P){if(k){var Z=Math.abs(P[1].x-P[0].x);var Y=Math.abs(P[1].y-P[0].y);var V=Math.sqrt(Z*Z+Y*Y);var O=V/r;var W=m.width*O;var X=m.height*O;var U={left:C.x,top:C.y};var T=(P[0].x+P[1].x)*0.5-U.left;var R=(P[0].y+P[1].y)*0.5-U.top;var S=T-W*M.x;var Q=R-X*M.y;I.style.width=W+"px";I.style.height=X+"px";I.style.left=S+"px";I.style.top=Q+"px"}}function L(){var P=I.offsetWidth;var O=I.offsetHeight;var R=I.style.left.slice(0,-2);var Q=I.style.top.slice(0,-2);R=0;Q=0;I.style.width=P+"px";I.style.height=O+"px"}function y(O){k=false;o.x=parseInt(I.style.left.slice(0,-2));o.y=parseInt(I.style.top.slice(0,-2));p=O;E=true;return false}function q(Q){if(E){var P=o.x+Q.x-p.x;var O=o.y+Q.y-p.y;I.style.left=P+"px";I.style.top=O+"px"}return false}function N(){var R=parseInt(I.style.left.slice(0,-2));var Q=parseInt(I.style.top.slice(0,-2));if(R<=0){var P=I.offsetWidth;if((R+P)<h.offsetWidth){R=h.offsetWidth-P}}if(Q<=0){var O=I.offsetHeight;if((Q+O)<h.offsetHeight){Q=h.offsetHeight-O}}if(x){I.style.left=R+"px";I.style.top=Q+"px"}}var c={init:function(){c.creatDom()},creatDom:function(){if(F==0){var S=document.getElementsByTagName("body")[0];var R='<canvas id="myCanvas" style="position: absolute;bottom: -1000px;visibility: hidden;"></canvas>';var Q='<div id="upHandle" style="position: absolute;bottom: -1000px;visibility: hidden;"><input type="file" accept="image/*" id="loadImg"'+u+"></div>";S.innerHTML=S.innerHTML+R+Q}else{var R='<canvas id="myCanvas" style="position: absolute;top: -1000px;visibility: hidden;"></canvas>';var Q='<div id="upHandle" style="position: absolute;top: -1000px;visibility: hidden;"><input type="file" accept="image/*" id="loadImg"'+u+"></div>";var T=document.getElementsByTagName("body")[0];T.innerHTML=T.innerHTML+R+Q;var S=document.getElementById(F)}var P="width:"+i.w+"px;height:"+i.h+"px;position:absolute;left:"+C.x+"px;top:"+C.y+"px;overflow:hidden;";var U="<img src='' id='preImg' style='left: 0;top: 0;position: absolute;' />";var X="width:"+i.w+"px;height:"+i.h+"px;position:absolute;overflow:hidden;background-color:rgba(0,0,0,.7);visibility:hidden";var O="position: absolute;width: "+z.w+"px;height: "+z.h+"px;left: 50%;top:50%;margin-left: -"+z.w/2+"px;margin-top: -"+z.h/2+"px;";var W="<div id='Imgload' style='"+X+"'><img src='"+n+"' style='"+O+"' /></div>";var V="<div id='makePhoto' style="+P+">"+U+W+"</div>";S.innerHTML=S.innerHTML+V;c.findDom()},findDom:function(){s=document.getElementById("myCanvas");D=document.getElementById("loadImg");h=document.getElementById("makePhoto");b=document.getElementById("Imgload");I=document.getElementById("preImg");if(s.getContext){G=s.getContext("2d")}}};return c.init()};